<!DOCTYPE html>
<html>
<head>
    <title>Valid Login Credentials</title>
    <style>
        body { font-family: Arial; margin: 20px; background: #f5f5f5; }
        .container { max-width: 900px; margin: 0 auto; }
        h1 { color: #333; }
        .header { background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .cred-table { width: 100%; border-collapse: collapse; background: white; margin-bottom: 20px; }
        .cred-table th, .cred-table td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        .cred-table th { background: #0066cc; color: white; font-weight: bold; }
        .cred-table tr:hover { background: #f9f9f9; }
        .note { background: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; }
        .error-help { background: #f8d7da; padding: 15px; border-radius: 5px; margin: 20px 0; }
        .dept-section { margin: 30px 0; }
        .dept-header { background: #0066cc; color: white; padding: 10px; border-radius: 5px; font-weight: bold; font-size: 1.1em; }
        code { background: #f0f0f0; padding: 2px 6px; border-radius: 3px; font-family: monospace; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>✅ System Login Credentials</h1>
            <p><strong>Status:</strong> All users configured and ready</p>
            <p><strong>Password for all users:</strong> <code>1234</code></p>
            <p><strong>Total Users:</strong> 18</p>
        </div>

        <div class="note">
            <strong>ℹ️ How to login:</strong>
            <ol>
                <li>Navigate to <code>http://localhost:3003/index.html</code></li>
                <li>Click on your department portal (Finance, ICT, Branch, Customer Service)</li>
                <li>Select your email from the dropdown</li>
                <li>Enter password: <code>1234</code></li>
                <li>Click Login</li>
            </ol>
        </div>

        <div id="credentials"></div>

        <div class="error-help">
            <strong>❌ If you get "Invalid credentials" error:</strong>
            <ul>
                <li>Make sure you're <strong>selecting from the dropdown</strong>, not typing</li>
                <li>Check that password is <code>1234</code> (no spaces, case-sensitive)</li>
                <li>Check browser console for JavaScript errors (F12)</li>
                <li>Try a different email in your portal</li>
            </ul>
        </div>
    </div>

    <script>
        fetch('/api/users')
            .then(r => r.json())
            .then(data => {
                const users = data.users || [];
                const byDept = {};
                users.forEach(u => {
                    const dept = u.department || 'Unknown';
                    if (!byDept[dept]) byDept[dept] = [];
                    byDept[dept].push(u);
                });

                let html = '';
                Object.keys(byDept).sort().forEach(dept => {
                    html += `<div class="dept-section">`;
                    html += `<div class="dept-header">${dept} Portal</div>`;
                    html += `<table class="cred-table">`;
                    html += `<thead><tr><th>Email</th><th>Name</th><th>Role</th></tr></thead>`;
                    html += `<tbody>`;
                    byDept[dept].forEach(u => {
                        html += `<tr><td><code>${u.email}</code></td><td>${u.full_name}</td><td>${u.role}</td></tr>`;
                    });
                    html += `</tbody></table></div>`;
                });

                document.getElementById('credentials').innerHTML = html;
            })
            .catch(err => {
                document.getElementById('credentials').innerHTML = 
                    `<div class="error-help"><strong>⚠️ Error loading credentials:</strong> ${err.message}</div>`;
            });
    </script>
</body>
</html>
